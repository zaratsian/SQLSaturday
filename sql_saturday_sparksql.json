{"paragraphs":[{"config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488856703885_-1605891870","id":"20170307-031823_75353476","dateCreated":"2017-03-07T03:18:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:11487","text":"%pyspark\n\nmm_season = spark.read.load(\"/SeasonResults.csv\", format=\"csv\", header=True)\n\nmm_season.show()\nmm_season.count()\nmm_season.dtypes\n","dateUpdated":"2017-03-07T04:20:57+0000","dateFinished":"2017-03-07T03:20:11+0000","dateStarted":"2017-03-07T03:19:57+0000","title":"Spark - Load Data (Season Data)","result":{"code":"ERROR","type":"TEXT","msg":"Spark 2.1.0 is not supported"},"focus":true},{"title":"Spark - Load Data (Team Data)","text":"%pyspark\n\nmm_teams = spark.read.load(\"/Teams.csv\", format=\"csv\", header=True)\n\nmm_teams.show()\nmm_teams.count()\nmm_teams.dtypes\n","dateUpdated":"2017-03-07T04:21:48+0000","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860363518_-1223629897","id":"20170307-041923_96904250","dateCreated":"2017-03-07T04:19:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:12769","dateFinished":"2017-03-07T04:21:48+0000","dateStarted":"2017-03-07T04:21:48+0000","result":{"code":"ERROR","type":"TEXT","msg":"Spark 2.1.0 is not supported"},"focus":true},{"text":"%pyspark\n\nmm_season.createOrReplaceTempView('mm_season_sql')\n","dateUpdated":"2017-03-07T04:22:55+0000","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860467935_-1134014051","id":"20170307-042107_1745056502","dateCreated":"2017-03-07T04:21:07+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12699","title":"Create TempTable "},{"config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860494905_1820578672","id":"20170307-042134_260645458","dateCreated":"2017-03-07T04:21:34+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12845","dateUpdated":"2017-03-07T04:23:03+0000","title":"Create TempTable","text":"%pyspark\n\nmm_teams.createOrReplaceTempView('mm_teams_sql')\n"},{"text":"%pyspark\n\nspark.sql('''   \n    select ID,SEASON,WTEAM,LTEAM from mm_season_sql\n    ''').show(10)","dateUpdated":"2017-03-07T04:23:25+0000","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488856886567_-584339212","id":"20170307-032126_501654052","dateCreated":"2017-03-07T03:21:26+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12926","title":"SparkSQL Query"},{"config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488856749992_-123576952","id":"20170307-031909_18343698","dateCreated":"2017-03-07T03:19:09+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11558","text":"%sql\n\nselect ID,SEASON,WTEAM,LTEAM from mm_season_sql\n\n","dateUpdated":"2017-03-07T04:24:35+0000","title":"Alternative SQL Query (Spark)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488857732891_112464592","id":"20170307-033532_1914696367","dateCreated":"2017-03-07T03:35:32+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12456","text":"%pyspark\n\nmm_join1 = spark.sql('''                                                                                                                       \n    SELECT mm_season_sql.*, \n        teams2a.team_name AS WTEAM_NAME, \n        teams2b.team_name AS LTEAM_NAME\n    FROM mm_season_sql\n    LEFT JOIN mm_teams_sql teams2a ON (mm_season_sql.wteam = teams2a.team_id)\n    LEFT JOIN mm_teams_sql teams2b ON (mm_season_sql.lteam = teams2b.team_id)\n''')\n\nmm_join1.show()","dateUpdated":"2017-03-07T04:25:04+0000","title":"Spark Join & Aggregations"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860731598_2000811368","id":"20170307-042531_245169718","dateCreated":"2017-03-07T04:25:31+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13032","text":"%pyspark\n\nmm_join1.createOrReplaceTempView('mm_join1_sql')\n","dateUpdated":"2017-03-07T04:25:50+0000"},{"config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860740751_-1520795315","id":"20170307-042540_2072243639","dateCreated":"2017-03-07T04:25:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13102","text":"%pyspark\n\nspark.sql('''  \n    SELECT WTEAM_NAME, COUNT(*) AS WINS \n        FROM mm_join1 \n        GROUP BY WTEAM_NAME \n        ORDER BY WINS DESC\n    ''').show(15)\n","dateUpdated":"2017-03-07T04:26:36+0000","title":"Calculate the Top 15 Teams with the most Wins"},{"config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860760961_-333647388","id":"20170307-042600_1521401205","dateCreated":"2017-03-07T04:26:00+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13175","dateUpdated":"2017-03-07T04:27:22+0000","title":"Calculate the Top 15 Teams with the most Losses","text":"%pyspark\n\nspark.sql('''  \n    SELECT LTEAM_NAME, COUNT(*) AS LOSSES \n        FROM mm_join1 \n        GROUP BY LTEAM_NAME \n        ORDER BY LOSSES DESC \n    ''').show(15)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1488860831186_473079110","id":"20170307-042711_455152199","dateCreated":"2017-03-07T04:27:11+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13263","text":"%pyspark\n\nfrom pyspark.sql import HiveContext\n\nhive_context = HiveContext(sc)\n\nhive_context.sql('show tables').show(25,False)\n\nsample = hive_context.table(\"default.sample_07\")\nsample.show(10,False)\n\nsample.registerTempTable(\"sample_temp\")\nhive_context.sql('show tables').show(25,False)\nhive_context.sql(\"select * from sample_temp\").show()","dateUpdated":"2017-03-07T04:28:06+0000","title":"Spark on Hive Table"}],"name":"SQLSaturday_Spark","id":"2CDJF3RB3","angularObjects":{"2CAVREYZ5:shared_process":[],"2CAYV7NT1:shared_process":[],"2CA3GG1HR:shared_process":[],"2CA6M8R42:shared_process":[],"2CDFPK1YR:shared_process":[],"2CBM2SR9N:shared_process":[],"2CD9BXMK6:shared_process":[],"2CBQ5WW6U:shared_process":[],"2C9NP116Z:shared_process":[],"2CAYZ2F77:shared_process":[],"2CA6WK78N:shared_process":[],"2CAXAC9VA:shared_process":[],"2CAPMRM4Q:shared_process":[],"2CBHPXARF:shared_process":[],"2CC6HA2PH:shared_process":[],"2CDCMXTWQ:shared_process":[],"2C9QJHE4M:shared_process":[],"2CC8SP56N:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}